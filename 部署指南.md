# 🚀 部署到线上指南

## 推荐方案对比

| 平台 | 免费额度 | 难度 | 推荐指数 | 说明 |
|------|---------|------|---------|------|
| **Vercel** | ✅ 免费 | ⭐ 简单 | ⭐⭐⭐⭐⭐ | 最推荐！支持Node.js，自动部署 |
| **Railway** | ✅ 有限免费 | ⭐⭐ 简单 | ⭐⭐⭐⭐ | 很好用，免费额度有限 |
| **Render** | ✅ 免费 | ⭐⭐ 简单 | ⭐⭐⭐⭐ | 免费tier，但可能较慢 |
| **Fly.io** | ✅ 有限免费 | ⭐⭐⭐ 中等 | ⭐⭐⭐ | 需要信用卡验证 |

---

## 方案1：Vercel部署（推荐！）

### 准备工作

1. **注册Vercel账号**
   - 访问：https://vercel.com
   - 用GitHub账号登录（推荐）

2. **安装Vercel CLI（可选）**
   ```bash
   npm install -g vercel
   ```

### 部署步骤

#### 方式A：通过GitHub自动部署（推荐）

1. **创建GitHub仓库**
   ```bash
   cd /Users/ivan/Desktop/mh_w
   git init
   git add .
   git commit -m "Initial commit"
   ```

2. **推送到GitHub**
   ```bash
   # 在GitHub创建新仓库后
   git remote add origin https://github.com/你的用户名/仓库名.git
   git branch -M main
   git push -u origin main
   ```

3. **在Vercel导入项目**
   - 登录 https://vercel.com
   - 点击 "New Project"
   - 选择你的GitHub仓库
   - 点击 "Deploy"
   - 等待部署完成

4. **获取线上地址**
   - 部署完成后会得到一个地址，如：
   - `https://你的项目名.vercel.app`

#### 方式B：通过CLI部署（更快）

```bash
# 在项目目录下
cd /Users/ivan/Desktop/mh_w
vercel

# 按提示操作：
# - 选择或创建项目
# - 确认设置
# - 等待部署完成
```

### 使用部署后的地址

部署成功后，你的iframe地址变为：
```html
<iframe 
    src="https://你的项目名.vercel.app/dashboard-small.html" 
    width="480" 
    height="360"
    frameborder="0">
</iframe>
```

---

## 方案2：Railway部署

### 步骤

1. **注册Railway**
   - 访问：https://railway.app
   - 用GitHub登录

2. **创建新项目**
   - 点击 "New Project"
   - 选择 "Deploy from GitHub repo"
   - 选择你的仓库

3. **等待自动部署**
   - Railway会自动检测Node.js项目
   - 自动安装依赖并启动

4. **获取公网地址**
   - 在项目设置中生成域名
   - 格式：`https://xxx.up.railway.app`

---

## 方案3：Render部署

### 步骤

1. **注册Render**
   - 访问：https://render.com
   - 用GitHub登录

2. **创建Web Service**
   - 点击 "New +"
   - 选择 "Web Service"
   - 连接GitHub仓库

3. **配置设置**
   - Build Command: `npm install`
   - Start Command: `npm start`
   - 选择免费tier

4. **部署**
   - 点击 "Create Web Service"
   - 等待部署完成

---

## 环境变量配置

如果需要配置环境变量（比如数据库连接）：

### Vercel
在项目设置 → Environment Variables 添加：
```
PORT=3000
NODE_ENV=production
```

### Railway/Render
在Dashboard的环境变量设置中添加

---

## 数据持久化方案

部署到线上后，如果需要真实数据：

### 选项1：使用云数据库
- **MongoDB Atlas**（免费）- 推荐
- **PlanetScale**（免费MySQL）
- **Supabase**（免费PostgreSQL）

### 选项2：使用云存储
- 将CSV/JSON文件上传到：
  - GitHub仓库（data目录）
  - 对象存储（S3、OSS等）

### 选项3：定期同步数据
- 使用GitHub Actions定时任务
- 从MediaCrawler服务器同步数据到GitHub

---

## 本地测试部署版本

在部署前测试生产环境：

```bash
# 设置环境变量
export NODE_ENV=production

# 启动
npm start
```

---

## 常见问题

### Q: 部署后显示错误？
A: 检查：
1. package.json中的依赖是否完整
2. Node版本是否兼容（建议14+）
3. 查看部署日志

### Q: 如何自定义域名？
A: 
- Vercel: 项目设置 → Domains
- Railway: Settings → Domains
- Render: Settings → Custom Domain

### Q: 免费版有限制吗？
A:
- Vercel: 100GB带宽/月，足够用
- Railway: $5免费额度/月
- Render: 750小时/月，不活跃会休眠

### Q: 如何更新部署？
A: 
- 推送代码到GitHub会自动部署
- 或使用CLI: `vercel --prod`

---

## 推荐的完整部署流程

```bash
# 1. 初始化Git
cd /Users/ivan/Desktop/mh_w
git init
git add .
git commit -m "Initial commit"

# 2. 推送到GitHub
# （先在GitHub创建仓库）
git remote add origin https://github.com/你的用户名/mediacrawler-dashboard.git
git push -u origin main

# 3. 部署到Vercel
vercel --prod

# 完成！获得线上地址
```

---

## 下一步

1. ✅ 已创建 `vercel.json` 配置文件
2. 📝 按照上述步骤部署
3. 🎉 获得线上地址后更新iframe的src

需要帮助或遇到问题随时问我！
